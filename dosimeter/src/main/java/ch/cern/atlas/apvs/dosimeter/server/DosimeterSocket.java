package ch.cern.atlas.apvs.dosimeter.server;

import java.io.IOException;
import java.io.OutputStream;
import java.io.PrintStream;
import java.net.Socket;

public class DosimeterSocket implements Runnable {

	private String[] doses = {
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08903702000005740D00002064A700010000000000007D",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D06002064A7000100000000000077",
			"08903702000005740D00002064A700010000000000007D",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08903702000005740D03002064A700010000000000007A",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D00002064A700010000000000007D",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D030020C4AF0001000000000000F3",
			"08884202000000950D030020C4AF0001000000000000F3",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A",
			"08884202000000950D000020C4AF0001000000000000F6",
			"08903702000005740D03002064A700010000000000007A" };

	private Socket socket;

	public DosimeterSocket(Socket socket) {
		this.socket = socket;
	}

	@Override
	public void run() {
		try {
			OutputStream os = socket.getOutputStream();
			PrintStream out = new PrintStream(os);
			int i = 0;
			while (true) {
				out.println(doses[i++]);
				if (i >= doses.length) {
					i = 0;
				}
				out.flush();
				try {
					Thread.sleep(5000);
				} catch (InterruptedException e) {
					// ignored
				}
				System.err.print(".");
				System.err.flush();
			}

		} catch (IOException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
	}
}
